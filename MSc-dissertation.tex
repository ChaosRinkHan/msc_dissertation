\documentclass[12pt,a4paper]{report}

\usepackage{epcc}
\usepackage{graphics}

% This example file shows how a thesis can be laid out using Latex. It
% does not use any special local features so should be portable to other
% places.
% 
% When producing draft copies of a thesis you may want to print only
% selected pages of the thesis. To do this use the command
% 
% dvips -f -p 4 -n 3 myfile.dvi | lpr
% 
% where -p 4 means start printing at page 4 (ie the page that will be
% numbered 4, not necessarily the 4th page) and -n 3 means print 3 pages.
% This example will print pages 4, 5 and 6.
% 
% If you want to print the thesis and also save paper you can print more
% than one page on each sheet of paper. Use the command
% 
% dvips -f myfile.dvi | psnup -2 | lpr
% 
% to print 2 pages per sheet. psnup can take values 2, 4, 8, or 9.
%
% To produce a PDF version you can create a PostScript copy first
%
% dvips -f myfile.dvi > myfile.pdf
%
% and then convert it
%
% distill myfile.ps
%
% or you can go straight to PDF
%
% pdflatex myfile
%
% Note that pdflatex expects all included figures to be in PDF too. See
% the includegraphics command below.


% This document contains many cross-references and forward references,
% eg in constructing a table of contents, so Latex may need to be run
% twice to get all the references correct. If you need to run Latex twice
% you may get the warning:
% 
% LaTeX Warning: Label(s) may have changed. Rerun to get cross-refSerences right.


% the following 4 lines are the content of the smallmargins.sty file
% but including them explicitly makes this more portable.
%AC%\oddsidemargin=0.1in
%AC%\topmargin=-0.5in
%AC%\textheight=9in
%AC%\textwidth=6.25in

%AC%\parskip 10pt
%AC%\parindent 0in

\begin{document}

%AC%\pagestyle{myheadings}
%AC%\markright{D.~S.~Henty}

%\title{A Latex thesis example}
%\author{D.~S.~Henty}
%\date{\today}

%\maketitle

\pagenumbering{roman}

\title{Bayesian Inference Using Sequential Monte-Carlo Algorithm for Dynamic System Models}
\author{Chaolin Han}
\date{\today}

\makeEPCCtitle

\thispagestyle{empty}

\vspace{11cm}

\begin{center}

\large{MSc in High Performance Computing}

\large{The University of Edinburgh}

\large{Year of Presentation: 2020}

\end{center}

\newpage

\begin{abstract}
This is the bit where you summarise what is in your thesis.
\end{abstract}

\pagenumbering{roman}

\tableofcontents
\listoftables
\listoffigures

\begin{titlepage}
\vspace*{2in}
% an acknowledgements section is completely optional but if you decide
% not to include it you should still include an empty {titlepage}
% environment as this initialises things like section and page numbering.
\section*{Acknowledgements}

This template is a slightly modified version of the one developed by
Prof. Charles Duncan for MSc students in the Dept. of Meteorology. His
acknowledgement follows:

{\em This template has been produced with help from many former students who
have shown different ways of doing things. Please make suggestions for
further improvements.}

\end{titlepage}

\pagenumbering{arabic}

\chapter{Introduction}
This should contain a description of your project and the problem you
are trying to solve. Where appropriate you should also include
references to work which has already been done on your topic and
anything else which lets you set your work in context.

One of the things you will need to do is to ensure that you have a
suitable list of references.  To do this you should see \cite{ref:lam}
or some other suitable reference.  Note the format of the citation used
here is the style favoured in this department.  Here is another
reference \cite{ref:bloggs} for good measure.

You will also want to make sure you have no spelling or grammatical
mistakes. To help idwentify spelling mistukes you caan use the commands
{\em ispell} or {\em spell}. See the appropriate manual pages. Remember
that spelling mistakes are not the only errors which can occur. Spelling
checkers will not find errors which are, in fact, valid words such as
{\em there} for {\em their}, nor will they find repeated words which
sometimes occur if your concentration is broken when typing. {\bf There
is no substitute for thorough proof reading!}

\chapter{Background}

\section{Zebrafish spinal cord regeneration}


\section{Mathematical modelling}


\subsection{Hard bits}
You might want to include an equation here:

\begin{equation} \delta N_{\nu} = (\delta N_{\nu})_{ex} + (\delta N_{\nu})_{au} 
\label{equation:delsplit}
% note that the label is optional but allows you to refer to this
% equation later.
\end{equation}


\subsection{Even harder bits}
This might be one of the places where you might want to refer to
equation \ref{equation:delsplit}. You will usually need to use the
Latex command twice to make cross-references like this work properly.
The cross-reference information is stored in the {\em .aux} file so don't
delete it.

\subsubsection{Numbering}
You can keep subdividing but eventually you get to a level where
numbering stops. This text is in a subsubsection which is not numbered
by default.


\paragraph{More on numbering:}

This text is in a paragraph which is also not numbered by default and
the ``title'' of the paragraph is not on a separate line.
If you want to increase the depth to which sections are numbered you
should see the section on setting the secnumdepth counter in the manual. 

\section{Bayesian inference}

\section{Software tools}

\chapter{Mathematical modelling}

Mathematical models can describe different kinds of dynamic system, and can be used as a guide to prediction and analysis. An ideal model in this case, can represent reasonable interactions/effects between cells and cytokines and recover the observed  trend against time. 

Models for the regeneration process is in the form of ordinary differential equations, specifically the time differential form. Terms in the ODE are mostly explainable and corresponds interaction paths. 

\section{Observed data}

Our models is built regarding the existing experiments data form Tsarouchas et al.\cite{ref:Tsarouchas}. The measurement includes the number of three kinds of cells (neutrophil $N$, macrophage $\Phi$ and microglia) and the relative concentration of four cytokines (il-1$\beta$, tnf-$\alpha$, tgf-$\beta$1a and tgf-$\beta$3). As proposed in \cite{ref:Tsarouchas}, neutrophil and macrophage play important roles in the promotion of spinal cord regeneration with il-1$\beta$ and tnf-$\alpha$ being the mediation. According to this, our current models focus on the changes of four variables $N$, $\Phi $, $\beta$ (il-1$\beta$) and $\alpha$ (tnf-$\alpha$). $N$ and $\Phi$ is of the unit `number of cells', $\beta$ and $\alpha$ is of the unit `relative concentration'.

It is noted that the variance of the measured data is relatively high. The summary statistic used for the parameter estimations is mean of measurement, assuming that measured data is Gaussian-like distributed. The distribution of the measured data points is plotted and examined to see if the measurement mean could represent the distribution. The result is that at most time points the measurement values are Gaussian-distributed, some distributions are skewed. One abnormal distribution is observed at time point 120 h post-lesion (hpl) for macrophage where there are two concentrations. Mean value can summarise most data measures and thus is still used as the target summarised observed data. A plot of the mean of the four variables is shown in 

\begin{figure}

\begin{center}
\resizebox{1.0\hsize}{!}{\includegraphics{fig/obs_curve.png}}
\end{center}

\caption{Mean of the observed data for neutrophil $N$, macrophage $\Phi$, il-1$\beta$ and tnf-$\alpha$, from experiment results of \cite{ref:Tsarouchas}}
\label{fig:obs_data}

\end{figure}

\section{Hypothesis and Models}

\subsection{Basic model}

\subsection{Alternative models}

\subsection{Model evaluation and comparison}



% \begin{figure}

% \begin{center}
% \resizebox{0.30\hsize}{!}{\includegraphics{logos/crest_bw}}
% \end{center}

% \caption{The University Crest}
% \label{fig:eucrest}

% \end{figure}


% see the man page for dvips for details of the special command which is
% much more powerful than is shown here. It allows offsets in the
% horizontal and vertical and scaling in x and y.

% choosing suitable values for offset and scale can be a tiring matter
% of trial and error.

% note that labels do not need to include a description of the object
% they are labelling but it can be helpful, eg \label{fig:figurename}.

% You can use a label on a figure to refer to it later. The university
% crest is in \ref{fig:eucrest}. Note that you should not use phrases like
% ``the figure above'' or ``the following figure'' since Latex may move
% the figure relative to the text if it cannot be fitted onto the current page.

\chapter{Implementations and Experiments}

\section{Parameter estimation}
Here are some results.

\section{Model comparison}
Here are some results.

\section{Performance experiments}

The performance experiments are designed to explore the parallel performance of ABC SMC implementations. Usually ABC SMC is a time-consuming and computation intensive task and usually is executed on large clusters. The scheduling strategy, implementation details and many other factors can affect the parallel efficiency.

\subsection{Scaling-up}

First experiments are designed to illustrate the scaling-up performance. The program used here is an implementation of ABc SMC on model 5. The details of the ABC SMC settings is listed below

\begin{itemize}
    \item Prior distribution: default to log-uniform distribution [$1\times 10^{-6}$, 50] for all the 12 parameters
    \item threshold schedule: median epsilon
    \item No factors, no adaptive distance or adaptive population applied
    \item Population size is 2000, with 20 generations
\end{itemize}

HOW PYABC parallelise the sampling

For HPC systems like Cirrus, \verb|pyabc| uses \verb|multiprocessing| for multi-core parallel sampling. By default if the number of cores is not specified, it will automatically read the number of available cores and use them all. Cirrus has a 36-core CPU which support hyperthreading, such that the maximal number of cores available to \verb|multiprocessing| is 72.

The program is executed on Cirrus, using 8, 12, 16, 24, 36, 54, 72 cores respectively. Each run is repeated 5 times. The average execution time, required sampling numbers are recorded. Hyperthreading is enabled when using 54 and 72 cores. The access to the node that contains computation cores is exclusive, such that the execution would not be affected by other programs of operations.

The implementation of ABC SMC in \verb|pyabc| enables the parallelisation of sampling, which is the must time-consuming part. The rest part of the program is mostly not parallelised, e.g. database I/O and reductions operations. The sampling process involves sampling, perturbation and test of the acceptance criteria, all of which are computation-intensive. 

In practice, using ABC SMC to estimate the parameters of a given model could cost up to several hundred of hours if the computational resources is limited[REF]. The performance experiment result could provide a reference that illustrate that how the efficiency changes when scaling-up or the trade-offs in computational resources' cost and their benefit.

\subsection{Profiling}

The performance could also be analysed given a profiling report. The second experiment profiles the program to reveal the detailed time consumption for each operation and the possible bottleneck, according to which we could find the hot-spot of program and given possible suggestions on improving the performance. 

In this case, profile tools \verb|cProfile| and \verb|yappi| is used in PyCharm IDE.



\chapter{Results Analysis}

\section{ABC SMC results}

\section{Performance experiments}

\section{Discussions}
This is the place to put your conclusions about your work. You can
split it into different sections if appropriate. You may want to include
a section of future work which could be carried out to continue your
research.

\chapter{Future works}

\chapter{Conclusions}

\appendix
% the appendix command just changes heading styles for appendices.

\chapter{Stuff which is too detailed}

Appendices should contain all the material which is considered too
detailed to be included in the main bod but which is, nevertheless,
important enough to be included in the thesis.

\chapter{Stuff which no-one will read}

Some people include in their thesis a lot of detail, particularly
computer code, which no-one will ever read. You should be careful that
anything like this you include should contain some element of uniqueness
which justifies its inclusion.

\begin{thebibliography}{100}

\bibitem{ref:lam} L.Lamport. {\em 1986 Latex User's Guide
and Reference Manual.} Addison Wesley. pp242.

\bibitem{ref:bloggs} F.Bloggs. {\em 1993 Latex Users do it
in Environments} Int. Journal of Silly Findings. pp 23-29.

\bibitem{ref:Tsarouchas} Tsarouchas, T.M., Wehner, D., Cavone, L., Munir, T., Keatinge, M., Lambertus, M., Underhill, A., Barrett, T., Kassapis, E., Ogryzko, N. and Feng, Y., 2018. Dynamic control of proinflam- matory cytokines Il-1$\beta$ and Tnf-$\alpha$ by macrophages in zebrafish spinal cord regeneration. Nature communications, 9(1), pp.1-17.

\end{thebibliography}


\end{document}

